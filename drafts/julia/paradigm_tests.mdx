# paradigm_tests

# 测试范式

## 测试代码也是代码

覆盖率高的测试使我们的程序可维护，因为每次进行改动只需要确保通过测试就可以了。因此，测试决不是用完就扔的代码，而应该自动化地运行，以使得每一次改动都没有后顾之忧。

## 先有测试函数，再有运算函数

程序应该依类型和类型上的函数而内聚成一个个的文件，一个文件可以近似地看成是一个单元。在编写一个文件的时候，我们应该先写类型和运算函数的签名，然后在文件底部写好测试函数，使得这个测试恰好无法通过；然后我们去编写实际执行运算的函数，使得测试由不通过转为可以通过。

在小型项目中，可以在每个文件中加入

```
if basename(PROGRAM_FILE) == basename(@__FILE__)    test()end
```

来运行测试，而在大型项目中最好单独运用测试。

## 测试的内部结构

好的测试应该总是能拆分为「构造测试用例」——「运算」——「断言」三部分，其中断言可以用 `@assert` 宏实现。例如如果我们构造的一个类型中含有一个正交矩阵，断言正交矩阵乘以它的转置是不是约等于单位矩阵应该是一个好的断言。

```
operator = Operator(...)@assert operator.T * operator.T' ≈ operator.T' * operator.T ≈ I
```

## 如何获得测试用例

1. 测试程序的基础功能是不是能跑通；
2. 文献上的计算结果；
3. 组内公认的计算结果；
4. 自己积累的一些小模型系统的计算结果。
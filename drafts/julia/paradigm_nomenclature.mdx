# paradigm_nomenclature

# 命名范式

## 命名对象与一般讨论

在 Julia 中，可命名的实体分为三类：类型、函数和值。在最高的层次上概括地说，这三类实体采取以下的命名方式：

- 类型：大驼峰式命名（每个单词的首字母大写并连接在一起）
- 函数和值：小驼峰式命名（除第一个单词外每个单词的首字母大写并连接在一起）或单字母命名（见下）

大驼峰和小驼峰是软件开发中常用的命名方式，并且也是 Python 和 JavaScript 中许多内置函数和标准库中的命名方式，因此无需赘述。单字母命名则需要进行一些说明。在软件开发领域，单字母命名通常被认为是不好的命名方式，仅仅应该在类似于「很小的循环中的循环变量」这种场合加以使用。但在科学计算领域，由于数学公式中所有代数记号通常都是单字母的（单个英文字母、希腊字母或其他字母，并用上标、下标、改变字体等其他方式加以进一步区分），因而所有物理量也几乎都是单字母的。例如 *β* 在统计力学中几乎总是代表温度倒数，如果一定要在程序中把它命名为 `inverseTemperature` 虽然不是不可以，但徒增了理解上的「噪音」。对于这种情况，直接使用 `β` 作为变量名就是很好的选择（Julia 可以用 Unicode 字符作变量名）。使用单字母命名时可以无视大小写的要求，也可以带上相应的上标或者下标（例如量子微扰论中可以使用 `H₀` 作为变量名）。

但是物理量和「不是物理量」没有特别明显的区分，例如计算过程中的一些中间变量通常没有公认的单字母命名。为此我们提出了「背书原则」来解决这个问题：假设我们的研究工作要发表为一篇论文，那么所有在论文中出现的物理量单字母记法都可以作为程序中的单字母命名，否则就用小驼峰式命名。在「文档范式」中我们会进一步讨论如何将写论文和写程序之间实现「联动」。

（「背书原则」的「背书」出处：「在政治上，背书一词用来表示为某人或某事允诺保证，借此提高事物的可信度。该词来自金融术语，原意指在支票等背后签名表示支付、收到或同意转让等。」——引自维基百科。代码就是「支票」的正面，而论文就是「支票」的背面。）

下面我们讨论一些基本原则：

### 能使用单字母命名就不要使用小驼峰式命名

有论文背书的时候，单字母命名显得易懂得多，与科学计算的主旨也更符合。特别是能使用单个希腊字母就不要使用它的英文转写（`β = 1` 而不是 `beta = 1`），能把含义用上下标表达就不用另一个单词（`H₀` 而不是 `primitiveHamiltonian`）。

### 大小驼峰式命名采用完整的英文单词

完整的英文单词比较不好写。但是，正如《代码整洁之道》中所说的，一方面写程序时读以前代码的时间远多于写新代码的时间，另一方面现代编辑器的自动补全功能使得真正需要打的字符数量也大大减少了。例如一个描述一维量子系统的类型可能会被命名为 `1dqs`，但这看起来像是乱码。我们不如写

```
struct OneDimensionalQuantumSystem    β::Real    ...end
```

## 类型命名

类型命名是比较好解决的。正如「类型与函数范式」一节中提到的，类型一般表示某个物理概念，例如「传播子」「同构经典系统」等等，把这个概念逐词翻译成英语就可以了。

类型命名很大程度上决定了文件命名，因为一个文件在理想情况下应该包含的是一个类型和相应的方法，此时我们把文件的名字和类型的名字等同起来就可以了。

## 函数命名

首先排除那些单字母命名的情况。在函数的小驼峰式命名中，我们还可以进一步分为两种情况：

如果函数有返回值，那么函数的命名就是返回值的命名，这样转化为了一个值命名的问题。这样做是因为在函数式语言中，函数和函数的返回值在概念上没有多大的区别（例如 Lisp 里不区分值和函数、Fortran 里如果不使用 `result()` 语法则函数名可以直接在函数体中当成值的名称使用）。那么问题来了，如果返回值也需要命名，怎么办？首先，在 Julia 里面返回值可以不写 `return`，例如

```
f(x) = begin    y = 2x    y^2 + 1end
```

自动返回 `y^2 + 1`，因此返回的那个值在函数体中只会以表达式的形式出现。而如果你是先创建一个值，再把一些其他的值累加上去，然后返回，那确实会引起问题，但这种情况的出现一般说明程序写得不好（函数式编程里极少使用变量），应该考虑用 `sum()` 之类的函数来代替。

如果函数没有返回值，这实际上已经不属于函数式编程的范畴了，其效果肯定是对某个参数作出了修改，此时应该把修改动作的动词作为函数名称并加上感叹号，例如 `push!()`。

## 值命名

除了单字母命名外，值的小驼峰式命名应该遵守以下几个原则：

### 不说废话

「不说废话」有几层含义。首先，Julia 是强类型语言，我们可以通过写类型标注的方式让编辑器随时告诉我们一个变量的类型，所以没必要标注类型，例如 `preconditionerMatrix` 就不如 `preconditioner`。其次，尽量使用实词而非虚词和词根词缀。考虑一个简单的循环，

```
for phase in phases    ...end
```

`phases` 的类型是 `Array{Phase, 1}`，但这个命名没有体现出这个阵列中各个 `phase` 之间是什么关系。例如如果实际上它们是不同的样本，可以命名为 `phaseReplicates`。同理不要写 `aPhase`，`thePhase`。

### 把字面值变成常量

```
for i in 1:200000    integrator!(phase, system)    if mod(i, 10000) == 0        collect!(property, phase, system)    endend
```

这段程序想干什么？200000 和 10000 分别有什么意义？如果我们先定义 `const iterationTimes = 200000` 和 `const collectEveryThisTimes = 10000`，然后把这些常量的名称放入程序中，程序的意义就明确多了。

### 一词一义

把多词一义变成一词一义：程序的编写可能经过多个人之手，即使自己编写也可能历经比较长的一段时间，在这段时间内我们指向一个概念的用语可能会发生波动。例如 `map, operator, transformation` 可能都是指的某类映射，这时需要统一以避免混乱。

把一词多义变成一词一义：假设我们给两种不同的类型都定义了二元函数 `+`，但 A 类型 `x + y = y + x`，而 B 类型 `x + y != y + x`，那么我们不妨把 B 类型的这个函数改名叫 `*` 或者 `×` 等等，这样更符合习惯。